<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui" xmlns:o="http://omnifaces.org/ui">
<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>Usuário</title>
	<h:outputStylesheet library="css" name="dashboard.css" />
	<h:outputStylesheet>	
	
	.ui-widget-content {
    border: 0px solid #a8a8a8;
   
}.ui-fileupload-buttonbar {
     padding: 0px
}

.ui-widget-header {
   border: 0px solid #a8a8a8; 
  
   background: white;
  
    color: #333;
    font-weight: bold;
   text-shadow: 0 0px 0 rgba(255,255,255,0.7);
}
.ui-button-text-icon-left .ui-button-text {
    padding: .3em 1em .3em 2.1em;
}
	.ui-paginator.ui-paginator-top {	display: none;	}	
	.ui-paginator.ui-paginator-top {
		 background-color: white;
		 border: 1px solid #fff;
	}
  	.ui-datatable thead th {
	 	border: 1px solid #fff;
	 }  	
  	.ui-datatable-tablewrapper {
  	    overflow: hidden; 
  	}
  	.ui-state-default {
  		background-color: white;
  		background: white;  		
	}	
	.ui-datatable table {
    	border-collapse: collapse;
    	width: 100%;
    }
	table {
   		border-collapse: separate;
    	border-spacing: 2px;
	}
	.ui-datatable table thead {
		border-bottom:1px solid rgb(147, 184, 189);
		border-top: 2px solid white;
		border-left: 2px solid white;
		border-right: 2px solid white;
	}
	</h:outputStylesheet>	
</h:head>
<h:body style="overflow-y:hidden;">
	<div id="nav" >	
		<div align="center" >			
				<p:commandButton actionListener="#{usuarioController.btnDlgNovoContato(autenticadorController.usuario)}" icon="fa  fa-user" style="cursor: pointer;  
						  background: tomato;	 
						  border: 1px solid #fff;   
						  margin-bottom: 10px;
						  color:white;  
						  text-shadow: 0 1px 1px #333;	 
						  -webkit-border-radius: 5px;
						  border-radius: 5px;	 
						  transition: all 0.2s linear;" />		
				<p:commandButton action="#{autenticadorController.logout}" icon="fa  fa-sign-out" style="cursor: pointer;  
						  background: tomato;	 
						  border: 1px solid #fff;   
						  margin-bottom: 10px;
						  color:white;  
						  text-shadow: 0 1px 1px #333;	 
						  -webkit-border-radius: 5px;
						  border-radius: 5px;	 
						  transition: all 0.2s linear;"/>		
		</div>
	</div>
	<div id="conteudo">	
	<div id="avatar">			
		<div class="ui-g-12" align="center">
			<div class="ui-g-12" >
				<p:graphicImage value="/resources/images/user_avatar.png"	 styleClass="avatarimg"		/>
			</div>
			<div class="ui-g-12">
				<h:outputText value="#{autenticadorController.login}"	/>
			</div>
			<div class="ui-g-12" >
				<p:commandButton actionListener="#{usuarioController.btnDlgEditar(autenticadorController.usuario)}" icon="fa fa-pencil-square-o" />	
				</div>
			</div>			
	</div>
	

		<h:form id="formInserir">
			<p:growl id="growl" />
			<p:autoUpdate />
			<p:dialog id="dlgInserir" widgetVar="dlgInserir" modal="true"	header="Novo Usuário">
				<p:panelGrid id="panelInserir" columns="2">
					<p:outputLabel value="Nome" />
					<p:inputText value="#{usuarioController.usuario.nome}" />
					<p:outputLabel value="Fone" />
					<p:inputMask id="fone" value="#{usuarioController.usuario.fone}"
						mask="(99)9999-9999" />
					<p:commandButton value="salvar"	actionListener="#{usuarioController.inserir}"  />
				</p:panelGrid>
			</p:dialog>
		</h:form>

		<h:form id="formEditar">
			<p:dialog id="dlgEditar" widgetVar="dlgEditar" modal="true" resizable="false"	header="Editar">
				<div  id="avatarForm">
					<div align="center">
					    <p:graphicImage id="photoPreview" value="#{fotoBean.streamedFoto}" 
							cache="false" style="width: 150px;
							height: 150px;
							border-radius: 50%;
							border: 1px solid rgba(147, 184, 189, 0.8);" >							
						</p:graphicImage>
					</div>
					<div align="center">				
						<p:fileUpload id="photo" value="#{fotoBean.file}" mode="advanced" label="foto" 
							fileUploadListener="#{fotoBean.handlePhotoUpload}" auto="true"
							allowTypes="/(\.|\/)(gif|jpe?g|png)$/" update="photoPreview" />					
					</div>
				</div>
					<h:panelGrid columns="2" >							
						<p:outputLabel for="nome">Nome:</p:outputLabel>
						<p:inputText id="nome" value="#{usuarioController.usuarioSelecionado.nome}" />					
					
						<p:outputLabel for="fone" > Fone:</p:outputLabel>
						<p:inputMask id="fone"	value="#{usuarioController.usuarioSelecionado.fone}"	mask="(99)9999-9999"	required="true" />
				
						<p:outputLabel for="nascimento" > Nascimento:</p:outputLabel>
						<p:inputText id="nascimento"	value="#{usuarioController.usuarioSelecionado.dataNasc}"	required="true" />						
						
						<p:outputLabel for="email" > Email:</p:outputLabel>
						<p:inputText id="email"	value="#{usuarioController.usuarioSelecionado.email}"	required="true" />					
					
						<p:outputLabel for="login" > Login:</p:outputLabel>		
						<p:inputText id="login"	value="#{usuarioController.usuarioSelecionado.login}"	required="true" />				
					
						<p:outputLabel for="senha" > Senha:</p:outputLabel>
						<p:inputText id="senha" value="#{usuarioController.usuarioSelecionado.senha}"	required="true" />			
					
						<p:commandButton value="salvar"	actionListener="#{usuarioController.editar}" />					
				</h:panelGrid>
			</p:dialog>
		</h:form>

	<h:form id="formNovoContato" enctype="multipart/form-data">		
		<p:dialog id="dlgNovoContato" widgetVar="dlgNovoContato" modal="true"  resizable="false"	header="Novo Contato de #{usuarioController.usuarioSelecionado.nome}">
			<div  id="avatarForm">
				<div align="center">
					<p:graphicImage id="photoPreview" value="#{fotoBean.streamedFoto}" 
						cache="false" style="width: 130px;
						height: 130px;
						border: 1px solid rgba(147, 184, 189, 0.8);
						border-radius: 50%;" >							
					</p:graphicImage>
				<div align="center">
					<p:fileUpload id="photo" value="#{fotoBean.file}" mode="advanced"
						fileUploadListener="#{fotoBean.handlePhotoUpload}" auto="true"
						allowTypes="/(\.|\/)(gif|jpe?g|png)$/" update="photoPreview"  />
				</div>
				</div>
			</div>						
			<h:panelGrid columns="2">
				<p:outputLabel for="nome" > Nome:</p:outputLabel>				
				<p:inputText id="nome" value="#{usuarioController.contato.nome}"	placeholder="Entre com o Nome"	required="true" />		
					
				<p:outputLabel for="fone" > Fone:</p:outputLabel>						
				<p:inputMask id="fone" value="#{usuarioController.contato.fone}" placeholder="Entre com o Fone"	 mask="(99)9999-9999" required="true" />
				
				<p:outputLabel for="email" > Email:</p:outputLabel>					
				<p:inputText id="email" value="#{usuarioController.contato.email}"	placeholder="Entre com o Email"	required="true" />
				
				<p:outputLabel for="nascimento" > Data de Nascimento:</p:outputLabel>	
				<p:calendar id="nascimento" value="#{usuarioController.contato.dtNasc}"  pattern="dd/MM/yyyy" mask="true" placeholder="Entre com o Data" required="true"  >
					<o:converter converterId="javax.faces.DateTime"  pattern="dd/MM/yyyy" />
				</p:calendar>							
				
				<p:commandButton value="salvar"	ajax="false" actionListener="#{usuarioController.novoContato}" update="dtbContatos" />
			</h:panelGrid>
		</p:dialog>		
				
		<p:dataTable id="dtbContatos" var="contato" widgetVar="" paginator="true"  scrollable="false" rows="3"	value="#{usuarioController.obterContotatosPorUsuario(autenticadorController.usuario)}" paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" rowsPerPageTemplate="3,6,9"> 
			<p:column style="  border: 1px solid rgb(147, 184, 189);">
				<div class="ui-g-3" style="border:0px solid red">
					<p:graphicImage id="photoPreview" value="#{fotoBean.streamedFotos}" cache="false" 
						style="width: 100px;
							height: 100px;
							border: 1px solid rgba(147, 184, 189, 0.8);">
						<f:param id="foto_id" name="foto_id" value="#{contato.id}" />
					</p:graphicImage>				    				
				</div>
				<div class="ui-g-3" style="border:0px solid red">
					<h:outputText value="#{contato.nome}" />
				</div>
				<div class="ui-g-8" style="border:0px solid red">
					<h:outputText value="#{contato.fone}" />
				</div>
				<div class="ui-g-3" style="border:0px solid red">
					<h:outputText value="#{contato.email}" />
				</div>	
				<div class="ui-g-3" style="border:0px solid red">
					<h:outputText value="#{contato.dtNasc}"  >
						<o:converter converterId="javax.faces.DateTime"  pattern="dd/MM/yyyy" />
					</h:outputText>
				</div>					
				<div class="ui-g-3" style="border:0px solid red">						
					<p:commandButton icon="fa  fa-trash" actionListener="#{usuarioController.deleteContato(contato)}" immediate="true" update="dtbContatos" 
						style="cursor: pointer;  
						  background: tomato;	 
						  border: 1px solid #fff;   
						  margin-bottom: 10px;
						  color:white;  
						  text-shadow: 0 1px 1px #333;	 
						  -webkit-border-radius: 5px;
						  border-radius: 5px;	 
						  transition: all 0.2s linear;">
						<p:confirm header="Deletar" message="deseja remover #{contato.nome} ?"/>
					</p:commandButton>
					<p:commandButton  actionListener="#{usuarioController.btnDlgEditarContato(contato)}" immediate="true"  update="formEditarContato:dlgEditarContato" icon="fa  fa-pencil" styleClass="btnNovo" 
						style="cursor: pointer;  
						  background: #FFAD33;	 
						  border: 1px solid #fff;   
						  margin-bottom: 10px;
						  color:white;  
						  text-shadow: 0 1px 1px #333;	 
						  -webkit-border-radius: 5px;
						  border-radius: 5px;	 
						  transition: all 0.2s linear;"/>
					</div>				
				</p:column>				
			</p:dataTable>		
	</h:form>
	
	<h:form id="formEditarContato" enctype="multipart/form-data">			
		<p:dialog id="dlgEditarContato" widgetVar="dlgEditarContato" modal="true" resizable="false" >
			<div  id="avatarForm">
				<div align="center">
					<p:graphicImage id="photoPreview2" value="#{fotoBean.streamedFotoById}" cache="false" 
						style="width: 125px;
						height: 125px;
						border: 4px solid rgba(147, 184, 189, 0.8);
						border-radius: 50%;">
					</p:graphicImage>
				</div>
				<div align="center">
					<p:fileUpload id="fotoEditar" value="#{fotoBean.fileSelecionado}" mode="advanced"
							fileUploadListener="#{fotoBean.fotoUploadEditar}" auto="true"
							allowTypes="/(\.|\/)(gif|jpe?g|png)$/" update="photoPreview2"  />
				</div>
			</div>
			<h:panelGrid columns="2">
				<p:outputLabel for="nome">Nome:</p:outputLabel>
				<p:inputText id="nome" value="#{usuarioController.contatoSelecionado.nome}"	required="true" />
				
				<p:outputLabel for="fone">Fone:</p:outputLabel>
				<p:inputMask id="fone" value="#{usuarioController.contatoSelecionado.fone}"	mask="(99)9999-9999" required="true" />
				
				<p:outputLabel for="email">Email:</p:outputLabel>
				<p:inputText id="email" value="#{usuarioController.contatoSelecionado.email}" required="true" />
				
				<p:outputLabel for="nascimento">Nascimento:</p:outputLabel>
				<p:calendar id="nascimento" value="#{usuarioController.contatoSelecionado.dtNasc}"  pattern="dd/MM/yyyy" mask="true" required="true"  >
						<o:converter converterId="javax.faces.DateTime"  pattern="dd/MM/yyyy" />
				</p:calendar>			
					<p:commandButton value="salvar"	actionListener="#{usuarioController.editarContato}" update="formNovoContato:dtbContatos"/>
			</h:panelGrid>			
		</p:dialog>
	</h:form>
</div>

	<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
		<p:commandButton value="Yes" type="button"
			styleClass="ui-confirmdialog-yes" icon="pi pi-check" />
		<p:commandButton value="No" type="button"
			styleClass="ui-confirmdialog-no" icon="pi pi-times" />
	</p:confirmDialog>

	<p:ajaxStatus  delay="9000"  onstart="PF('statusDialog').show()" onsuccess="PF('statusDialog').hide()" />
             
	<p:dialog widgetVar="statusDialog" modal="true" draggable="false" closable="false" resizable="false" showHeader="false">
    	<p:graphicImage name="/images/ajaxloadingbar.gif"  />
	</p:dialog>
</h:body>
</html>
